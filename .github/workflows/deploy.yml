name: Engine3D Package Deployment

on:
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-22.04
    steps:
      - name: ðŸ“¡ Add `engnie3d` repo to conan remotes
        run: conan remote add engine3d
          https://libengine3d.jfrog.io/artifactory/api/conan/engine3d-dev-conan
          
      - name: ðŸ“¡ Sign into JFrog Artifactory
        if: ${{ inputs.version != '' }}
        env:
          PASSWORD: ${{ secrets.JFROG_ENGINE3D_TRUNKEN_ID_TOKEN }}
          JFROG_USER: ${{ secrets.JFROG_USERNAME }}
        run: conan remote login -p $PASSWORD engine3d-dev $JFROG_USER
      - name: ðŸ†™ Upload package version ${{ inputs.version }} to `engine3d` repo
        if: ${{ inputs.version != '' }}
        run: conan upload "${{ inputs.library }}/${{ inputs.version }}" --confirm -r=engine3d-dev
